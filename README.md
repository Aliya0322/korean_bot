# Korean Language Learning Bot

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![aiogram](https://img.shields.io/badge/aiogram-3.x-blue.svg)](https://docs.aiogram.dev/)
[![Mistral AI](https://img.shields.io/badge/Mistral_AI-Codestral-orange.svg)](https://mistral.ai)

Telegram-бот для изучения корейского языка с использованием искусственного интеллекта. Бот помогает пользователям изучать корейский язык через различные функции: проверку орфографии, ежедневную рассылку слов и квизов для подготовки к экзамену TOPIK.

![Телеграм бот](Телеграм%20бот.jpg)


## Основные функции

- **Проверка орфографии** - исправление ошибок в корейских текстах с объяснениями
- **Ежедневная рассылка слов** - автоматическая отправка слова дня в 9:00 утра с:
  - Корейским словом и переводом
  - Примером использования
  - Изображением слова
- **Ежедневные квизы** - автоматическая отправка квизов в 19:00 вечера с:
  - Предложением с пропущенным словом
  - Тремя вариантами ответа (инлайн-кнопки)
  - Проверкой правильности ответа
  - Одобряющими сообщениями при ошибках
- **Статистика** - отслеживание правильных ответов на квизы:
  - Общая статистика за все время
  - Процент правильных ответов
- **Подготовка к TOPIK** - подписка на ежедневную рассылку
- **Обратная связь** - система сообщений между пользователями и администратором
- **Лимит запросов** - ограничение количества запросов к ИИ в день (настраивается)

## Технологии

- **Python 3.8+** - основной язык программирования
- **aiogram 3.4.1** - библиотека для работы с Telegram Bot API
- **Mistral AI** - ИИ для обработки текстов и генерации ответов
- **SQLite** - база данных для хранения пользователей и статистики
- **APScheduler** - планировщик для ежедневной рассылки
- **python-dotenv** - управление переменными окружения

## Установка и настройка

### 1. Клонирование репозитория
```bash
git clone https://github.com/Aliya0322/korean_bot.git
cd korean_bot
```

### 2. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 3. Настройка переменных окружения
Создайте файл `.env` в корневой директории проекта:

```env
# Telegram Bot Configuration
BOT_TOKEN=your_telegram_bot_token
ADMIN_ID=your_admin_telegram_id

# Mistral AI Configuration
API_KEY=your_mistral_api_key
MODEL_NAME=codestral-latest

# Application Settings
MAX_REQUESTS_PER_DAY=10
```

### 4. Подготовка данных
- Убедитесь, что файл `words.json` содержит словарь корейских слов
- Убедитесь, что файл `quiz_data.json` содержит квизы для ежедневной рассылки
- Папка `images/` должна содержать изображения для слов дня

### 5. Запуск бота
```bash
python Telegram_Korean.py
```

## Структура проекта

```
korean_bot/
├── Telegram_Korean.py    # Основной файл бота
├── configuration.py      # Конфигурация и переменные окружения
├── db.py                # Работа с базой данных (пользователи, статистика)
├── scheduler.py         # Планировщик ежедневной рассылки
├── words.json           # Словарь корейских слов для рассылки
├── quiz_data.json       # Квизы для ежедневной рассылки
├── images/              # Изображения для слов дня
├── requirements.txt     # Зависимости Python
├── .env                 # Переменные окружения (не в git)
├── .gitignore           # Игнорируемые файлы
└── README.md            # Документация
```

## Функциональность

### Проверка орфографии
- Пользователь отправляет текст на корейском языке
- ИИ исправляет ошибки и объясняет изменения
- Поддержка различных стилей письма

### Ежедневная рассылка слов
- **Время отправки:** 9:00 утра каждый день
- Случайный выбор слова из базы данных
- Включение перевода, примера использования и изображения
- Возможность подписки/отписки

### Ежедневные квизы
- **Время отправки:** 19:00 вечера каждый день
- Предложение с пропущенным словом (из `quiz_data.json`)
- Три варианта ответа (1 правильный + 2 неправильных)
- Интерактивные инлайн-кнопки для выбора ответа
- Мгновенная проверка правильности ответа
- Показ правильного ответа при ошибке
- Одобряющие сообщения для мотивации
- Автоматическое сохранение статистики

### Статистика
- Просмотр статистики через кнопку "Моя статистика"
- Статистика за сегодня:
  - Количество правильных ответов
  - Общее количество ответов
  - Процент правильных ответов
- Общая статистика за все время

### Система обратной связи
- Пользователи могут отправлять сообщения администратору
- Администратор может отвечать через бота
- Логирование всех сообщений

## Настройка

### Лимит запросов
По умолчанию установлен лимит 10 запросов в день на пользователя. Измените значение `MAX_REQUESTS_PER_DAY` в `.env` файле.

### Время рассылки
Измените время в функции `main()` в файле `Telegram_Korean.py`:
```python
# Планируем отправку слова дня в 9:00
schedule_daily_word(scheduler=scheduler, hour=9, minute=0)

# Планируем отправку квиза в 19:00
schedule_daily_quiz(scheduler=scheduler, test_mode=False)
```

### Тестовый режим
Для тестирования квизов можно включить тестовый режим (отправка каждую минуту):
```python
schedule_daily_quiz(scheduler=scheduler, test_mode=True)
```

### База слов
Добавьте новые слова в файл `words.json`:
```json
{
  "word": "새로운",
  "translation": "новый",
  "image": "images/new.png",
  "example": "새로운 책이에요."
}
```

### База квизов
Добавьте новые квизы в файл `quiz_data.json`:
```json
{
  "quiz_questions": [
    {
      "word": "학교",
      "translation": "школа",
      "sentence": "저는 매일 ______에 가요.",
      "original_sentence": "저는 매일 학교에 가요.",
      "wrong_options": ["병원", "시장", "공원"]
    }
  ]
}
```

## Безопасность

- Все секретные данные хранятся в `.env` файле
- Файл `.env` добавлен в `.gitignore`
- Используется лимит запросов для предотвращения злоупотреблений
- Валидация входных данных
- Проверка прав доступа для администраторских функций

## База данных

Бот использует SQLite базу данных `korean_bot.db` с следующими таблицами:

- **users** - список пользователей бота
- **quiz_stats** - статистика ответов на квизы
- **active_quizzes** - активные квизы пользователей (для хранения `original_sentence`)

## Логирование

Бот ведет логи всех операций:
- Ошибки отправки сообщений
- Действия администратора
- Ошибки работы с базой данных
- Успешные отправки квизов и слов дня

## Развертывание

### Локальный запуск
```bash
python Telegram_Korean.py
```

### Запуск в фоне
```bash
nohup python Telegram_Korean.py > bot.log 2>&1 &
```

### Systemd сервис (Linux)
Создайте файл `/etc/systemd/system/KoreanBot.service`:
```ini
[Unit]
Description=Korean Language Learning Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/korean_bot
Environment="PATH=/path/to/venv/bin"
ExecStart=/path/to/venv/bin/python Telegram_Korean.py
Restart=always

[Install]
WantedBy=multi-user.target
```

Затем:
```bash
sudo systemctl daemon-reload
sudo systemctl enable KoreanBot
sudo systemctl start KoreanBot
```

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл `LICENSE` для получения дополнительной информации.

---

**Примечание**: Убедитесь, что у вас есть все необходимые API ключи и токены перед запуском бота.
